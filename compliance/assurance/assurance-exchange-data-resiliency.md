---
title: Resistencia de datos de Exchange Online en Microsoft 365
description: En este artículo, encuentre una explicación de los diversos aspectos de la resistencia de datos en Exchange Online y Microsoft 365.
ms.author: robmazz
author: robmazz
manager: laurawi
ms.reviewer: sosstah
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
- MS-Compliance
f1.keywords:
- NOCSH
ms.custom: seo-marvel-apr2020
titleSuffix: Microsoft Service Assurance
hideEdit: true
ms.openlocfilehash: 4782cb47bcd5da86daf11f01cb3a443a9b637c49
ms.sourcegitcommit: 024137a15ab23d26cac5ec14c36f3577fd8a0cc4
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/01/2021
ms.locfileid: "51497213"
---
# <a name="exchange-online-data-resiliency-in-microsoft-365"></a><span data-ttu-id="fe83e-103">Resistencia de datos de Exchange Online en Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="fe83e-103">Exchange Online data resiliency in Microsoft 365</span></span>

>[!IMPORTANT]
><span data-ttu-id="fe83e-104">A medida que seguimos invirtiendo en diferentes formas de conservar el contenido del buzón, anunciamos la retirada de las retenciones de In-Place en el Centro de administración de Exchange (EAC) en Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="fe83e-104">As we continue to invest in different ways to preserve mailbox content, we're announcing the retirement of In-Place Holds in the Exchange admin center (EAC) in Exchange Online.</span></span> <span data-ttu-id="fe83e-105">A partir del 1 de julio de 2020, no podrá crear nuevas In-Place retenciones.</span><span class="sxs-lookup"><span data-stu-id="fe83e-105">Starting July 1, 2020, you won't be able to create new In-Place Holds.</span></span> <span data-ttu-id="fe83e-106">Pero aún podrá administrar las retenciones de In-Place en el EAC o mediante el cmdlet **Set-MailboxSearch** en PowerShell de Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="fe83e-106">But you'll still be able to manage In-Place Holds in the EAC or by using the **Set-MailboxSearch** cmdlet in Exchange Online PowerShell.</span></span> <span data-ttu-id="fe83e-107">Sin embargo, a partir del 1 de octubre de 2020, no podrá administrar las In-Place retenciones.</span><span class="sxs-lookup"><span data-stu-id="fe83e-107">However, starting October 1, 2020, you won't be able to manage In-Place Holds.</span></span> <span data-ttu-id="fe83e-108">Solo podrá quitarlos en el EAC o mediante el cmdlet **Remove-MailboxSearch.**</span><span class="sxs-lookup"><span data-stu-id="fe83e-108">You'll only be able to remove them in the EAC or by using the **Remove-MailboxSearch** cmdlet.</span></span> <span data-ttu-id="fe83e-109">Se seguirá In-Place las Exchange Server y las implementaciones híbridas de Exchange.</span><span class="sxs-lookup"><span data-stu-id="fe83e-109">Using In-Place Holds in Exchange Server and Exchange hybrid deployments will still be supported.</span></span> <span data-ttu-id="fe83e-110">Para obtener más información acerca de la retirada de In-Place en Exchange Online, vea [Retirement of legacy eDiscovery tools](/microsoft-365/compliance/legacy-ediscovery-retirement).</span><span class="sxs-lookup"><span data-stu-id="fe83e-110">For more information about the retirement of In-Place Holds in Exchange Online, see [Retirement of legacy eDiscovery tools](/microsoft-365/compliance/legacy-ediscovery-retirement).</span></span>

<span data-ttu-id="fe83e-111">Una conservación local conserva todo el contenido de un buzón de correo, incluidos los elementos eliminados y las versiones originales de los elementos modificados.</span><span class="sxs-lookup"><span data-stu-id="fe83e-111">An In-Place Hold preserves all mailbox content, including deleted items and original versions of modified items.</span></span> <span data-ttu-id="fe83e-112">Todos los elementos del buzón de correo se devuelven en una búsqueda de [Exhibición de documentos electrónicos en contexto](/exchange/security-and-compliance/in-place-ediscovery/in-place-ediscovery).</span><span class="sxs-lookup"><span data-stu-id="fe83e-112">All such mailbox items are returned in an [In-Place eDiscovery](/exchange/security-and-compliance/in-place-ediscovery/in-place-ediscovery) search.</span></span> <span data-ttu-id="fe83e-113">Cuando se coloca una retención de In-Place en el buzón de un usuario, el contenido del buzón de archivo correspondiente (si está habilitado) también se coloca en espera y se devuelve en una búsqueda de exhibición de documentos electrónicos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-113">When you place an In-Place Hold on a user's mailbox, the contents in the corresponding archive mailbox (if it's enabled) are also placed on hold and returned in an eDiscovery search.</span></span>

<span data-ttu-id="fe83e-114">Hay dos tipos de daños que pueden afectar a una base de datos de Exchange: daños físicos, que suelen deberse a problemas de hardware (en particular, hardware de almacenamiento) y daños lógicos, que se producen debido a otros factores.</span><span class="sxs-lookup"><span data-stu-id="fe83e-114">There are two types of corruption that can affect an Exchange database: physical corruption, which is typically caused by hardware (in particular, storage hardware) problems, and logical corruption, which occurs due to other factors.</span></span> <span data-ttu-id="fe83e-115">Por lo general, hay dos tipos de daños lógicos que pueden producirse en una base de datos de Exchange:</span><span class="sxs-lookup"><span data-stu-id="fe83e-115">Generally, there are two types of logical corruption that can occur within an Exchange database:</span></span>

- <span data-ttu-id="fe83e-116">**Daños lógicos de la** base de datos: la suma de comprobación de la página de base de datos coincide, pero los datos de la página son incorrectos lógicamente.</span><span class="sxs-lookup"><span data-stu-id="fe83e-116">**Database logical corruption** - The database page checksum matches, but the data on the page is wrong logically.</span></span> <span data-ttu-id="fe83e-117">Esto puede ocurrir cuando el motor de base de datos (el motor de almacenamiento extensible (ESE)) intenta escribir una página de base de datos y, aunque el sistema operativo devuelve un mensaje de éxito, los datos nunca se escriben en el disco o se escriben en el lugar incorrecto.</span><span class="sxs-lookup"><span data-stu-id="fe83e-117">This can occur when the database engine (the Extensible Storage Engine (ESE)) attempts to write a database page and even though the operating system returns a success message, the data is either never written to the disk or it's written to the wrong place.</span></span> <span data-ttu-id="fe83e-118">Esto se conoce como vaciado *perdido*.</span><span class="sxs-lookup"><span data-stu-id="fe83e-118">This is referred to as a *lost flush*.</span></span> <span data-ttu-id="fe83e-119">ESE incluye numerosas características y protecciones diseñadas para evitar daños físicos de una base de datos y otros escenarios de pérdida de datos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-119">ESE includes numerous features and safeguards that are designed to prevent physical corruption of a database and other data loss scenarios.</span></span> <span data-ttu-id="fe83e-120">Para evitar que los vaciados perdidos pierdan datos, ESE incluye un mecanismo de detección de vaciado perdido en la base de datos junto con una característica (restauración de una sola página) para corregirlo.</span><span class="sxs-lookup"><span data-stu-id="fe83e-120">To prevent lost flushes from losing data, ESE includes a lost flush detection mechanism in the database along with a feature (single page restore) to correct it.</span></span>
- <span data-ttu-id="fe83e-121">**Almacenar daños lógicos:** los datos se agregan, eliminan o manipulan de forma que el usuario no espera.</span><span class="sxs-lookup"><span data-stu-id="fe83e-121">**Store logical corruption** - Data is added, deleted, or manipulated in a way that the user doesn't expect.</span></span> <span data-ttu-id="fe83e-122">Estos casos son causados por aplicaciones de terceros.</span><span class="sxs-lookup"><span data-stu-id="fe83e-122">These cases are caused by third-party applications.</span></span> <span data-ttu-id="fe83e-123">Por lo general, se trata de daños en el sentido de que el usuario lo ve como dañado.</span><span class="sxs-lookup"><span data-stu-id="fe83e-123">It's usually corruption in the sense that the user views it as corruption.</span></span> <span data-ttu-id="fe83e-124">El almacén de Exchange considera que la transacción que produce los daños de lógica es una serie de operaciones MAPI válidas.</span><span class="sxs-lookup"><span data-stu-id="fe83e-124">The Exchange store considers the transaction that produced the logical corruption to be a series of valid MAPI operations.</span></span> <span data-ttu-id="fe83e-125">Las [características de retención](/exchange/security-and-compliance/create-or-remove-in-place-holds) local en Exchange Online proporcionan protección contra daños lógicos del almacén (ya que impide que un usuario o una aplicación eliminen el contenido de forma permanente).</span><span class="sxs-lookup"><span data-stu-id="fe83e-125">The [In-Place Hold](/exchange/security-and-compliance/create-or-remove-in-place-holds) features in Exchange Online provides protection from store logical corruption (because it prevents content from being permanently deleted by a user or an application).</span></span> 

<span data-ttu-id="fe83e-126">Exchange Online realiza varias comprobaciones de coherencia en archivos de registro replicados durante la inspección de registros y la reproducción de registros.</span><span class="sxs-lookup"><span data-stu-id="fe83e-126">Exchange Online performs several consistency checks on replicated log files during both log inspection and log replay.</span></span> <span data-ttu-id="fe83e-127">Estas comprobaciones de coherencia impiden que el sistema replique los daños físicos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-127">These consistency checks prevent physical corruption from being replicated by the system.</span></span> <span data-ttu-id="fe83e-128">Por ejemplo, durante la inspección del registro, hay una comprobación de integridad física que comprueba el archivo de registro y valida que la suma de comprobación registrada en el archivo de registro coincide con la suma de comprobación generada en la memoria.</span><span class="sxs-lookup"><span data-stu-id="fe83e-128">For example, during log inspection, there is a physical integrity check that verifies the log file and validates that the checksum recorded in the log file matches the checksum generated in memory.</span></span> <span data-ttu-id="fe83e-129">Además, se examina el encabezado del archivo de registro para asegurarse de que la firma del archivo de registro registrada en el encabezado del registro coincide con la del archivo de registro.</span><span class="sxs-lookup"><span data-stu-id="fe83e-129">In addition, the log file header is examined to make sure the log file signature recorded in the log header matches that of the log file.</span></span> <span data-ttu-id="fe83e-130">Durante la reproducción del registro, el archivo de registro se somete a un mayor escrutinio.</span><span class="sxs-lookup"><span data-stu-id="fe83e-130">During log replay, the log file undergoes further scrutiny.</span></span> <span data-ttu-id="fe83e-131">Por ejemplo, el encabezado de base de datos también contiene la firma de registro que se compara con la firma del archivo de registro para asegurarse de que coinciden.</span><span class="sxs-lookup"><span data-stu-id="fe83e-131">For example, the database header also contains the log signature that is compared with the log file's signature to ensure they match.</span></span> 

<span data-ttu-id="fe83e-132">La protección contra daños de los datos de buzones en Exchange Online se logra con Exchange Native Data Protection, una estrategia de resistencia que aprovecha la replicación a nivel de aplicación en varios servidores y varios centros de datos, junto con otras características que ayudan a proteger los datos de pérdidas debido a daños u otros motivos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-132">Protection against corruption of mailbox data in Exchange Online is achieved by using Exchange Native Data Protection, a resiliency strategy that leverages application-level replication across multiple servers and multiple datacenters along with other features that help protect data from being lost due to corruption or other reasons.</span></span> <span data-ttu-id="fe83e-133">Estas características incluyen características nativas administradas por Microsoft o la propia aplicación de Exchange Online, como:</span><span class="sxs-lookup"><span data-stu-id="fe83e-133">These features include native features that are managed by Microsoft or the Exchange Online application itself, such as:</span></span>

- [<span data-ttu-id="fe83e-134">Grupos de disponibilidad de datos</span><span class="sxs-lookup"><span data-stu-id="fe83e-134">Data Availability Groups</span></span>](/exchange/back-up-email)
- <span data-ttu-id="fe83e-135">Corrección de un solo bit</span><span class="sxs-lookup"><span data-stu-id="fe83e-135">Single Bit Correction</span></span> 
- <span data-ttu-id="fe83e-136">Análisis de bases de datos en línea</span><span class="sxs-lookup"><span data-stu-id="fe83e-136">Online Database Scanning</span></span> 
- <span data-ttu-id="fe83e-137">Detección de vaciado perdido</span><span class="sxs-lookup"><span data-stu-id="fe83e-137">Lost Flush Detection</span></span> 
- <span data-ttu-id="fe83e-138">Restauración de una sola página</span><span class="sxs-lookup"><span data-stu-id="fe83e-138">Single Page Restore</span></span> 
- <span data-ttu-id="fe83e-139">Servicio de replicación de buzones</span><span class="sxs-lookup"><span data-stu-id="fe83e-139">Mailbox Replication Service</span></span> 
- <span data-ttu-id="fe83e-140">Comprobaciones de archivos de registro</span><span class="sxs-lookup"><span data-stu-id="fe83e-140">Log File Checks</span></span> 
- <span data-ttu-id="fe83e-141">Implementación en el sistema de archivos resistente</span><span class="sxs-lookup"><span data-stu-id="fe83e-141">Deployment on Resilient File System</span></span> 

<span data-ttu-id="fe83e-142">Para obtener más información sobre las características nativas enumeradas anteriormente, seleccione los hipervínculos y vea lo siguiente para obtener información adicional y detalles sobre los elementos sin hipervínculos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-142">For more information on the native features listed previously, select the hyperlinks, and see the following for additional information and for details on items without hyperlinks.</span></span> <span data-ttu-id="fe83e-143">Además de estas características nativas, Exchange Online también incluye características de resistencia de datos que los clientes pueden administrar, como:</span><span class="sxs-lookup"><span data-stu-id="fe83e-143">In addition to these native features, Exchange Online also includes data resiliency features that customers can manage, such as:</span></span> 
- [<span data-ttu-id="fe83e-144">Recuperación de elementos únicos (habilitada de forma predeterminada)</span><span class="sxs-lookup"><span data-stu-id="fe83e-144">Single Item Recovery (enabled by default)</span></span>](/exchange/recipients-in-exchange-online/manage-user-mailboxes/recover-deleted-messages) 
- [<span data-ttu-id="fe83e-145">Conservación local y retención por juicio</span><span class="sxs-lookup"><span data-stu-id="fe83e-145">In-Place Hold and Litigation Hold</span></span>](/exchange/security-and-compliance/in-place-and-litigation-holds) 
- [<span data-ttu-id="fe83e-146">Retención de elementos eliminados y Soft-Deleted buzones de correo (ambos habilitados de forma predeterminada)</span><span class="sxs-lookup"><span data-stu-id="fe83e-146">Deleted Item Retention and Soft-Deleted Mailboxes (both enabled by default)</span></span>](/exchange/recipients-in-exchange-online/delete-or-restore-mailboxes) 

## <a name="database-availability-groups"></a><span data-ttu-id="fe83e-147">Grupos de disponibilidad de base de datos</span><span class="sxs-lookup"><span data-stu-id="fe83e-147">Database Availability Groups</span></span> 
<span data-ttu-id="fe83e-148">Todas las bases de datos de buzones de Microsoft 365 se hospedan en un grupo de disponibilidad de bases de datos [(DAG)](/exchange/back-up-email) y se replican en centros de datos separados geográficamente dentro de la misma región.</span><span class="sxs-lookup"><span data-stu-id="fe83e-148">Every mailbox database in Microsoft 365 is hosted in a [database availability group (DAG)](/exchange/back-up-email) and replicated to geographically separate datacenters within the same region.</span></span> <span data-ttu-id="fe83e-149">La configuración más común son cuatro copias de base de datos en cuatro centros de datos; sin embargo, algunas regiones tienen menos centros de datos (las bases de datos se replican en tres centros de datos en india y dos centros de datos en Australia y Japón).</span><span class="sxs-lookup"><span data-stu-id="fe83e-149">The most common configuration is four database copies in four datacenters; however, some regions have fewer datacenters (databases are replicated to three datacenters in India, and two datacenters in Australia and Japan).</span></span> <span data-ttu-id="fe83e-150">Pero en todos los casos, cada base de datos de buzones de correo tiene cuatro copias distribuidas en varios centros de datos, lo que garantiza que los datos del buzón estén protegidos contra errores de software, hardware e incluso centros de datos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-150">But in all cases, every mailbox database has four copies that are distributed across multiple datacenters, thereby ensuring that mailbox data is protected from software, hardware, and even datacenter failures.</span></span> 

<span data-ttu-id="fe83e-151">De estas cuatro copias, tres de ellas están configuradas como altamente disponibles.</span><span class="sxs-lookup"><span data-stu-id="fe83e-151">Out of these four copies, three of them are configured as highly available.</span></span> <span data-ttu-id="fe83e-152">La cuarta copia se configura como [una copia de base de datos con latencia.](/Exchange/high-availability/manage-ha/activate-lagged-db-copies)</span><span class="sxs-lookup"><span data-stu-id="fe83e-152">The fourth copy is configured as a [lagged database copy](/Exchange/high-availability/manage-ha/activate-lagged-db-copies).</span></span> <span data-ttu-id="fe83e-153">La copia de base de datos con latencia no está diseñada para la recuperación individual de buzones de correo o la recuperación de elementos de buzón.</span><span class="sxs-lookup"><span data-stu-id="fe83e-153">The lagged database copy is not intended for individual mailbox recovery or mailbox item recovery.</span></span> <span data-ttu-id="fe83e-154">Su propósito es proporcionar un mecanismo de recuperación para el raro evento de daños lógicos catastróficos en todo el sistema.</span><span class="sxs-lookup"><span data-stu-id="fe83e-154">Its purpose is to provide a recovery mechanism for the rare event of system-wide, catastrophic logical corruption.</span></span> 

<span data-ttu-id="fe83e-155">Las copias de base de datos con retraso en Exchange Online se configuran con un tiempo de retraso de reproducción de archivos de registro de siete días.</span><span class="sxs-lookup"><span data-stu-id="fe83e-155">Lagged database copies in Exchange Online are configured with a seven-day log file replay lag time.</span></span> <span data-ttu-id="fe83e-156">Además, el Administrador de retrasos de reproducción de Exchange está habilitado para proporcionar la reproducción dinámica de archivos de registro para copias con retraso para permitir que las copias de la base de datos con retraso se puedan reparar automáticamente y administrar el crecimiento del archivo de registro.</span><span class="sxs-lookup"><span data-stu-id="fe83e-156">In addition, the Exchange Replay Lag Manager is enabled to provide dynamic log file play down for lagged copies to allow lagged database copies to self-repair and manage log file growth.</span></span> <span data-ttu-id="fe83e-157">Aunque en Exchange Online se usan copias de base de datos con latencia, es importante comprender que no son una copia de seguridad de momento garantizada.</span><span class="sxs-lookup"><span data-stu-id="fe83e-157">Although lagged database copies are used in Exchange Online, it is important to understand that they are not a guaranteed point-in-time backup.</span></span> <span data-ttu-id="fe83e-158">Las copias de base de datos con latencia en Exchange Online tienen un umbral de disponibilidad, normalmente en torno al 90 %, debido a los períodos en los que el disco que contiene una copia con un tiempo de espera se pierde debido a un error en el disco, la copia latente se convierte en una copia de alta disponibilidad (debido a la reproducción automática), así como los períodos en los que la copia de la base de datos de latencia está recompilando la cola de reproducción de registros.</span><span class="sxs-lookup"><span data-stu-id="fe83e-158">Lagged database copies in Exchange Online have an availability threshold, typically around 90%, due to periods where the disk containing a lagged copy is lost due to disk failure, the lagged copy becoming a highly available copy (due to automatic play down), as well as the periods where the lagged database copy is rebuilding the log replay queue.</span></span> 

## <a name="transport-resilience"></a><span data-ttu-id="fe83e-159">Resistencia de transporte</span><span class="sxs-lookup"><span data-stu-id="fe83e-159">Transport Resilience</span></span> 
<span data-ttu-id="fe83e-160">Exchange Online incluye dos características de resistencia de transporte principales: Redundancia de instantáneas y Red de seguridad.</span><span class="sxs-lookup"><span data-stu-id="fe83e-160">Exchange Online includes two primary transport resilience features: Shadow Redundancy and Safety Net.</span></span> <span data-ttu-id="fe83e-161">La redundancia de instantáneas mantiene una copia redundante de un mensaje mientras está en tránsito.</span><span class="sxs-lookup"><span data-stu-id="fe83e-161">Shadow Redundancy keeps a redundant copy of a message while it is in transit.</span></span> <span data-ttu-id="fe83e-162">La red de seguridad conserva una copia redundante de un mensaje después de que el mensaje se entregue correctamente.</span><span class="sxs-lookup"><span data-stu-id="fe83e-162">Safety Net keeps a redundant copy of a message after the message is successfully delivered.</span></span> 

<span data-ttu-id="fe83e-163">Con la redundancia de instantáneas, cada servidor de transporte de Exchange Online realiza una copia de cada mensaje que recibe antes de que reconozca haber recibido correctamente el mensaje en el servidor de envío.</span><span class="sxs-lookup"><span data-stu-id="fe83e-163">With Shadow Redundancy, each Exchange Online transport server makes a copy of each message it receives before it acknowledges successfully receiving the message to the sending server.</span></span> <span data-ttu-id="fe83e-164">Esto hace que todos los mensajes de la canalización de transporte sea redundante mientras están en tránsito.</span><span class="sxs-lookup"><span data-stu-id="fe83e-164">This makes all messages in the transport pipeline redundant while in transit.</span></span> <span data-ttu-id="fe83e-165">Si Exchange Online determina que el mensaje original se perdió en tránsito, se reenvía una copia redundante del mensaje.</span><span class="sxs-lookup"><span data-stu-id="fe83e-165">If Exchange Online determines the original message was lost in transit, a redundant copy of the message is redelivered.</span></span> 

<span data-ttu-id="fe83e-166">Red de seguridad es una cola de transporte asociada al servicio de transporte en un servidor de buzones.</span><span class="sxs-lookup"><span data-stu-id="fe83e-166">Safety Net is a transport queue that is associated with the Transport service on a Mailbox server.</span></span> <span data-ttu-id="fe83e-167">Esta cola almacena copias de mensajes correctamente procesados por el servidor.</span><span class="sxs-lookup"><span data-stu-id="fe83e-167">This queue stores copies of messages that were successfully processed by the server.</span></span> <span data-ttu-id="fe83e-168">Cuando una base de datos de buzones o un error de servidor requiere activar una copia desuso de la base de datos de buzones de correo, los mensajes de la cola de red de seguridad se envían automáticamente a la nueva copia activa de la base de datos de buzones de correo.</span><span class="sxs-lookup"><span data-stu-id="fe83e-168">When a mailbox database or server failure requires activating an out-of-date copy of the mailbox database, messages in the Safety Net queue are automatically resubmitted to the new active copy of the mailbox database.</span></span> <span data-ttu-id="fe83e-169">La red de seguridad también es redundante, lo que elimina el transporte como un único punto de error.</span><span class="sxs-lookup"><span data-stu-id="fe83e-169">Safety Net is also redundant, thereby eliminating transport as a single point of failure.</span></span> <span data-ttu-id="fe83e-170">Usa el concepto de una red de seguridad principal y una red de seguridad de instantáneas en las que si la red de seguridad principal no está disponible durante más de 12 horas, las solicitudes de reenvío se convierten en solicitudes de reenvío de instantáneas y los mensajes se vuelven a enviar desde la red de seguridad de instantáneas.</span><span class="sxs-lookup"><span data-stu-id="fe83e-170">It uses the concept of a Primary Safety Net and a Shadow Safety Net wherein if the Primary Safety Net is unavailable for more than 12 hours, resubmit requests become shadow resubmit requests, and messages are redelivered from the Shadow Safety Net.</span></span>

<span data-ttu-id="fe83e-171">Las reenmisiones de mensajes desde la red de seguridad se inician automáticamente por el componente de Active Manager del servicio de replicación de Microsoft Exchange que administra dag y copias de bases de datos de buzones de correo.</span><span class="sxs-lookup"><span data-stu-id="fe83e-171">Message resubmissions from Safety Net are automatically initiated by the Active Manager component of the Microsoft Exchange Replication service that manages DAGs and mailbox database copies.</span></span> <span data-ttu-id="fe83e-172">No se requiere ninguna acción manual para reenviar mensajes desde la red de seguridad.</span><span class="sxs-lookup"><span data-stu-id="fe83e-172">No manual actions are required to resubmit messages from Safety Net.</span></span> 

## <a name="single-bit-correction"></a><span data-ttu-id="fe83e-173">Corrección de un solo bit</span><span class="sxs-lookup"><span data-stu-id="fe83e-173">Single Bit Correction</span></span> 
<span data-ttu-id="fe83e-174">ESE incluye un mecanismo para detectar y resolver errores CRC de un solo bit (también conocidos como volteos de un solo bit) que son el resultado de errores de hardware (y por lo tanto representan daños físicos).</span><span class="sxs-lookup"><span data-stu-id="fe83e-174">ESE includes a mechanism to detect and resolve single-bit CRC errors (also known as single-bit flips) that are the result of hardware errors (and as such they represent physical corruption).</span></span> <span data-ttu-id="fe83e-175">Cuando se producen estos errores, ESE los corrige automáticamente y registra un evento en el registro de eventos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-175">When these errors occur, ESE automatically corrects them and logs an event in the event log.</span></span> 

## <a name="online-database-scanning"></a><span data-ttu-id="fe83e-176">Análisis de bases de datos en línea</span><span class="sxs-lookup"><span data-stu-id="fe83e-176">Online Database Scanning</span></span> 
<span data-ttu-id="fe83e-177">El examen de bases de datos en línea (también conocido como suma de comprobaciones de base de *datos)* es el proceso en el que un ESE usa un control de coherencia de la base de datos para leer cada página y comprobar si hay daños en la página.</span><span class="sxs-lookup"><span data-stu-id="fe83e-177">Online database scanning (also known as *database check summing*) is the process where an ESE uses a database consistency checker to read each page and check for page corruption.</span></span> <span data-ttu-id="fe83e-178">El objetivo principal es detectar daños físicos y vaciados perdidos que pueden no detectarse mediante operaciones transaccionales.</span><span class="sxs-lookup"><span data-stu-id="fe83e-178">The primary purpose is to detect physical corruption and lost flushes that may not be getting detected by transactional operations.</span></span> <span data-ttu-id="fe83e-179">El examen de bases de datos también realiza operaciones de bloqueo posteriores al almacén.</span><span class="sxs-lookup"><span data-stu-id="fe83e-179">Database scanning also performs post-store crash operations.</span></span> <span data-ttu-id="fe83e-180">El espacio se puede perder debido a bloqueos y el análisis de bases de datos en línea busca y recupera espacio perdido.</span><span class="sxs-lookup"><span data-stu-id="fe83e-180">Space can be leaked due to crashes, and online database scanning finds and recovers lost space.</span></span> <span data-ttu-id="fe83e-181">El sistema está diseñado con la expectativa de que cada base de datos se examina completamente una vez cada siete días.</span><span class="sxs-lookup"><span data-stu-id="fe83e-181">The system is designed with the expectation that every database is fully scanned once every seven days.</span></span> 

## <a name="lost-flush-detection"></a><span data-ttu-id="fe83e-182">Detección de vaciado perdido</span><span class="sxs-lookup"><span data-stu-id="fe83e-182">Lost Flush Detection</span></span> 
<span data-ttu-id="fe83e-183">Un vaciado perdido se produce cuando una operación de escritura de base de datos que el subsistema de disco/sistema operativo devuelto como completado no se escribió realmente en el disco o se escribió en la ubicación incorrecta.</span><span class="sxs-lookup"><span data-stu-id="fe83e-183">A lost flush occurs when a database write operation that the disk subsystem/operating system returned as completed did not actually get written to disk, or was written in the wrong location.</span></span> <span data-ttu-id="fe83e-184">Los incidentes de vaciado perdidos pueden provocar daños lógicos en la base de datos, por lo que para evitar que los vaciados perdidos den como resultado la pérdida de datos, ESE incluye un mecanismo de detección de vaciado perdido.</span><span class="sxs-lookup"><span data-stu-id="fe83e-184">Lost flush incidents can result in database logical corruption, so to prevent lost flushes from resulting in lost data, ESE includes a lost flush detection mechanism.</span></span> <span data-ttu-id="fe83e-185">A medida que las páginas de base de datos se escriben en copias pasivas, se realiza una comprobación de los vaciados perdidos en la copia activa.</span><span class="sxs-lookup"><span data-stu-id="fe83e-185">As database pages are written to passive copies, a check is performed for lost flushes on the active copy.</span></span> <span data-ttu-id="fe83e-186">Si se detecta un vaciado perdido, ESE puede reparar el proceso mediante un proceso de revisión de página.</span><span class="sxs-lookup"><span data-stu-id="fe83e-186">If a lost flush is detected, ESE can repair the process using a page patching process.</span></span> 

## <a name="single-page-restore"></a><span data-ttu-id="fe83e-187">Restauración de una sola página</span><span class="sxs-lookup"><span data-stu-id="fe83e-187">Single Page Restore</span></span> 
<span data-ttu-id="fe83e-188">La restauración de una sola página, también conocida como revisión de *páginas,* es un proceso automático en el que las páginas de base de datos dañadas se reemplazan por copias en buen estado de una réplica en buen estado.</span><span class="sxs-lookup"><span data-stu-id="fe83e-188">Single page restore, also known as *page patching*, is an automatic process where corrupt database pages are replaced by healthy copies from a healthy replica.</span></span> <span data-ttu-id="fe83e-189">El proceso de reparación de una página dañada depende de si la copia de la base de datos es activa o pasiva.</span><span class="sxs-lookup"><span data-stu-id="fe83e-189">The repair process for a corrupt page depends on whether the database copy is active or passive.</span></span> <span data-ttu-id="fe83e-190">Cuando una copia de base de datos activa encuentra una página dañada, puede copiar una página de una de sus réplicas, siempre que la página que copie esté actualizada.</span><span class="sxs-lookup"><span data-stu-id="fe83e-190">When an active database copy encounters a corrupted page, it can copy a page from one of its replicas, provided the page it copies is up to date.</span></span> <span data-ttu-id="fe83e-191">Este proceso se realiza colocando una solicitud para la página en la secuencia de registro, que es la base de la replicación de bases de datos de buzones de correo.</span><span class="sxs-lookup"><span data-stu-id="fe83e-191">This process is accomplished by putting a request for the page into the log stream, which is the basis of mailbox database replication.</span></span> <span data-ttu-id="fe83e-192">Tan pronto como una réplica encuentra la solicitud de página, responde enviando una copia de la página a la copia de base de datos solicitante.</span><span class="sxs-lookup"><span data-stu-id="fe83e-192">As soon as a replica encounters the page request, it responds by sending a copy of the page to the requesting database copy.</span></span> <span data-ttu-id="fe83e-193">La restauración de una sola página también proporciona un mecanismo de comunicación asincrónica para que el activo solicite una página a réplicas, incluso si las réplicas están actualmente sin conexión.</span><span class="sxs-lookup"><span data-stu-id="fe83e-193">Single page restore also provides an asynchronous communication mechanism for the active to request a page from replicas, even if the replicas are currently offline.</span></span> 

<span data-ttu-id="fe83e-194">En caso de daños en una copia pasiva de base de datos, incluida una copia de base de datos atrasada, ya que estas copias siempre están detrás de su copia activa, siempre es seguro copiar cualquier página de la copia activa en una copia pasiva.</span><span class="sxs-lookup"><span data-stu-id="fe83e-194">In case of corruption in a passive database copy, including a lagged database copy, because these copies are always behind their active copy, it is always safe to copy any page from the active copy to a passive copy.</span></span> <span data-ttu-id="fe83e-195">Por naturaleza, una copia pasiva de base de datos está altamente disponible, por lo que durante el proceso de revisión de página, la reproducción de registros se suspende, pero la copia de registros continúa.</span><span class="sxs-lookup"><span data-stu-id="fe83e-195">A passive database copy is by nature highly available, so during the page patching process, log replaying is suspended, but log copying continues.</span></span> <span data-ttu-id="fe83e-196">La copia pasiva de la base de datos recupera una copia de la página dañada de la copia activa, espera hasta que se copia e inspecciona el archivo de registro que cumple el requisito máximo necesario de generación de registros y, a continuación, se revisa la página dañada.</span><span class="sxs-lookup"><span data-stu-id="fe83e-196">The passive database copy retrieves a copy of the corrupted page from the active copy, waits until the log file that meets the maximum required log generation requirement is copied and inspected, and then patches the corrupt page.</span></span> <span data-ttu-id="fe83e-197">Una vez que se ha parcheado la página, se reanuda la reproducción del registro.</span><span class="sxs-lookup"><span data-stu-id="fe83e-197">Once the page has been patched, log replay resumes.</span></span> <span data-ttu-id="fe83e-198">El proceso es el mismo para la copia de base de datos con latencia, excepto que la base de datos con latencia reproduce primero todos los archivos de registro necesarios para lograr un estado de revisión.</span><span class="sxs-lookup"><span data-stu-id="fe83e-198">The process is the same for the lagged database copy, except that the lagged database first replays all log files that are necessary to achieve a patchable state.</span></span> 

## <a name="mailbox-replication-service"></a><span data-ttu-id="fe83e-199">Servicio de replicación de buzones</span><span class="sxs-lookup"><span data-stu-id="fe83e-199">Mailbox Replication Service</span></span> 
<span data-ttu-id="fe83e-200">Mover buzones es una parte clave de la administración de un servicio de correo electrónico a gran escala.</span><span class="sxs-lookup"><span data-stu-id="fe83e-200">Moving mailboxes is a key part of managing a large-scale email service.</span></span> <span data-ttu-id="fe83e-201">Siempre hay tecnologías actualizadas y actualizaciones de hardware y versiones con las que tratar, por lo que tener un sistema robusto y con limitaciones que permita a nuestros ingenieros realizar este trabajo mientras mantienen el buzón de correo transparente para los usuarios (asegurándose de que permanezcan en línea durante todo el proceso) es clave y asegurarse de que el proceso se escala correctamente a medida que los buzones se hacen más grandes y grandes.</span><span class="sxs-lookup"><span data-stu-id="fe83e-201">There are always updated technologies and hardware and version upgrades to deal with, so having a robust, throttled system that enables our engineers to accomplish this work while keeping the mailbox moves transparent to users (by making sure they stay online throughout the process) is key and making sure that the process scales up gracefully as mailboxes get larger and larger.</span></span> 

<span data-ttu-id="fe83e-202">El Servicio de replicación de buzones de Exchange (MRS) es responsable de mover buzones entre bases de datos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-202">The Exchange Mailbox Replication Service (MRS) is responsible for moving mailboxes between databases.</span></span> <span data-ttu-id="fe83e-203">Durante el movimiento, MRS realiza una comprobación de coherencia en todos los elementos del buzón.</span><span class="sxs-lookup"><span data-stu-id="fe83e-203">During the move, MRS performs a consistency check on all items within the mailbox.</span></span> <span data-ttu-id="fe83e-204">Si se encuentra un problema de coherencia, MRS corregirá el problema o omitirá los elementos dañados, eliminando así los daños del buzón.</span><span class="sxs-lookup"><span data-stu-id="fe83e-204">If a consistency issue is found, MRS will either correct the problem, or skip the corrupted items, thereby removing the corruption from the mailbox.</span></span> 

<span data-ttu-id="fe83e-205">Dado que MRS es un componente de Exchange Online, podemos realizar cambios en su código para abordar nuevas formas de corrupción que se detectan en el futuro.</span><span class="sxs-lookup"><span data-stu-id="fe83e-205">Because MRS is a component of Exchange Online, we can make changes in its code to address new forms of corruption that are detected in the future.</span></span> <span data-ttu-id="fe83e-206">Por ejemplo, si detectamos un problema de coherencia que MRS no puede corregir, podemos analizar los daños, cambiar el código MRS y corregir la incoherencia (si entendemos cómo hacerlo).</span><span class="sxs-lookup"><span data-stu-id="fe83e-206">For example, if we detect a consistency issue that MRS is not able to fix, we can analyze the corruption, change the MRS code and correct the inconsistency (if we understand how to).</span></span> 

## <a name="log-file-checks"></a><span data-ttu-id="fe83e-207">Comprobaciones de archivos de registro</span><span class="sxs-lookup"><span data-stu-id="fe83e-207">Log File Checks</span></span> 
<span data-ttu-id="fe83e-208">Todos los archivos de registro de transacciones generados por una base de datos de Exchange se someten a varias formas de comprobaciones de coherencia.</span><span class="sxs-lookup"><span data-stu-id="fe83e-208">All transaction log files generated by an Exchange database undergo several forms of consistency checks.</span></span> <span data-ttu-id="fe83e-209">Cuando se crea un archivo de registro, lo primero que se hace es escribir un patrón de bits y, a continuación, se realiza una serie de escrituras de registro.</span><span class="sxs-lookup"><span data-stu-id="fe83e-209">When a log file is created, the first thing done is a bit pattern is written and then a series of log writes is performed.</span></span> <span data-ttu-id="fe83e-210">Esta estructura permite a Exchange Online ejecutar una serie de comprobaciones (vaciado perdido, CRC y otras comprobaciones) para validar cada archivo de registro tal como se escribe y de nuevo a medida que se replica.</span><span class="sxs-lookup"><span data-stu-id="fe83e-210">This structure enables Exchange Online to execute a series of checks (lost flush, CRC, and other checks) to validate each log file as it is written, and again as it is replicated.</span></span> 

## <a name="deployment-on-resilient-file-system"></a><span data-ttu-id="fe83e-211">Implementación en el sistema de archivos resistente</span><span class="sxs-lookup"><span data-stu-id="fe83e-211">Deployment on Resilient File System</span></span> 
<span data-ttu-id="fe83e-212">Para ayudar a evitar que se produzcan daños en el nivel del sistema de archivos, Exchange Online se está implementando en particiones de Sistema de archivos resistentes (ReFS) para proporcionar capacidades de recuperación mejoradas.</span><span class="sxs-lookup"><span data-stu-id="fe83e-212">To help prevent corruption from occurring at the file system level, Exchange Online is being deployed on Resilient File System (ReFS) partitions to provide improved recovery capabilities.</span></span> <span data-ttu-id="fe83e-213">ReFS es un sistema de archivos en Windows Server 2012 y versiones posteriores que está diseñado para ser más resistente frente a la corrupción de datos, maximizando así la integridad y la disponibilidad de los datos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-213">ReFS is a file system in Windows Server 2012 and later that is designed to be more resilient against data corruption thereby maximizing data availability and integrity.</span></span> <span data-ttu-id="fe83e-214">En concreto, ReFS aporta mejoras en la forma en que se actualizan los metadatos, lo que ofrece una mejor protección para los datos y reduce los casos de corrupción de datos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-214">Specifically, ReFS brings improvements in the way that metadata is updated which offers better protection for data and reduces data corruption cases.</span></span> <span data-ttu-id="fe83e-215">También usa sumas de comprobación para comprobar la integridad de los datos de archivos y los metadatos, lo que garantiza que los datos dañados se encuentran y reparan fácilmente.</span><span class="sxs-lookup"><span data-stu-id="fe83e-215">It also uses checksums to verify the integrity of file data and metadata ensuring that data corruption is easily found and repaired.</span></span> 

<span data-ttu-id="fe83e-216">Exchange Online aprovecha varias ventajas de ReFS:</span><span class="sxs-lookup"><span data-stu-id="fe83e-216">Exchange Online takes advantage of several ReFS benefits:</span></span> 
- <span data-ttu-id="fe83e-217">Una mayor resistencia en la integridad de los datos significa menos incidentes de corrupción de datos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-217">More resiliency in data integrity means fewer data corruption incidents.</span></span> <span data-ttu-id="fe83e-218">Reducir el número de incidentes de corrupción significa menos reediciones innecesarias de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-218">Reducing the number of corruption incidents means fewer unnecessary database reseeds.</span></span> 
- <span data-ttu-id="fe83e-219">Suma de comprobación que se ejecuta en metadatos que habilitan detecciones de casos de daños de forma más rápida y determinista, lo que nos permite corregir los daños en los datos de los clientes antes de que se produzcan errores grises en los volúmenes de datos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-219">Checksum running on metadata enabling detections of corruption cases sooner and more deterministically, allowing us to fix customer data corruption before grey failures occur on data volumes.</span></span>
- <span data-ttu-id="fe83e-220">Diseñado para funcionar bien con conjuntos de datos grandes (petabytes y más grandes) sin impacto en el rendimiento</span><span class="sxs-lookup"><span data-stu-id="fe83e-220">Designed to work well with large data sets—petabytes and larger—without performance impact</span></span>
- <span data-ttu-id="fe83e-221">Compatibilidad con otras características usadas por Exchange Online, como el cifrado de BitLocker.</span><span class="sxs-lookup"><span data-stu-id="fe83e-221">Support for other features used by Exchange Online, such as BitLocker encryption.</span></span> 

<span data-ttu-id="fe83e-222">Exchange Online también se beneficia de otras características de ReFS:</span><span class="sxs-lookup"><span data-stu-id="fe83e-222">Exchange Online also benefits from other ReFS features:</span></span> 
- <span data-ttu-id="fe83e-223">**Integridad (secuencias** de integridad): ReFS almacena los datos de una manera que lo protege de muchos de los errores comunes que normalmente pueden provocar la pérdida de datos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-223">**Integrity (Integrity Streams)** - ReFS stores data in a way that protects it from many of the common errors that can normally cause data loss.</span></span> <span data-ttu-id="fe83e-224">Búsqueda de Microsoft 365 usa secuencias de integridad para ayudar con la detección temprana de daños en disco y sumas de comprobación del contenido de archivos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-224">Microsoft 365 Search uses Integrity Streams to help with early disk corruption detection and checksums of file content.</span></span> <span data-ttu-id="fe83e-225">La característica también reduce los incidentes de daños causados por "Escrituras rotas" (cuando una operación de escritura no se completa debido a cortes de energía, etc.).</span><span class="sxs-lookup"><span data-stu-id="fe83e-225">The feature also reduces corruption incidents caused by “Torn Writes” (when a write operation does not complete due to power outages, etc.).</span></span> 
- <span data-ttu-id="fe83e-226">**Disponibilidad (salvamento):** ReFS prioriza la disponibilidad de datos.</span><span class="sxs-lookup"><span data-stu-id="fe83e-226">**Availability (Salvage)** - ReFS prioritizes the availability of data.</span></span> <span data-ttu-id="fe83e-227">Históricamente, los sistemas de archivos eran a menudo susceptibles a daños en los datos que requerirían que el sistema se desconectara para su reparación.</span><span class="sxs-lookup"><span data-stu-id="fe83e-227">Historically, file systems were often susceptible to data corruption that would require the system to be taken offline for repair.</span></span> <span data-ttu-id="fe83e-228">Aunque es poco frecuente, si se producen daños, ReFS implementa el salvamento, una característica que quita los datos dañados del espacio de nombres en un volumen en directo y garantiza que los datos buenos no se ven afectados negativamente por datos dañados no reparables.</span><span class="sxs-lookup"><span data-stu-id="fe83e-228">Although rare, if corruption does occur, ReFS implements salvage, a feature that removes the corrupt data from the namespace on a live volume and ensures that good data is not adversely affected by non-repairable corrupt data.</span></span> <span data-ttu-id="fe83e-229">Aplicar la característica de recuperación y aislar los daños de datos en los volúmenes de bases de datos de Exchange Online significa que podemos mantener las bases de datos no afectadas en un volumen dañado en buen estado entre el momento de los daños y las acciones de reparación.</span><span class="sxs-lookup"><span data-stu-id="fe83e-229">Applying the Salvage feature and isolating data corruption to Exchange Online database volumes means that we can keep non-affected databases on a corrupted volume healthy between the time of corruption and repair action.</span></span> <span data-ttu-id="fe83e-230">Esta estructura aumenta la disponibilidad de bases de datos que normalmente se verían afectadas por estos problemas de daños en el disco.</span><span class="sxs-lookup"><span data-stu-id="fe83e-230">This structure increases the availability of databases that would normally be affected by such disk corruption issues.</span></span> 
